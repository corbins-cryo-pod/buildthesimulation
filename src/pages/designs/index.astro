---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("designs"))
  .filter((p) => !p.data.draft)
  .sort((a, b) => stripPrefix(a.data.title).localeCompare(stripPrefix(b.data.title)));

function stripPrefix(title) {
  return title.replace(/^\d+\s*—\s*/, "");
}
---

<Layout
  pageTitle="Devices"
  subtitle="A catalog of brain–computer interface devices: architectures, modality classes, and what got built."
  description="BCI Devices: a catalog of architectures, modalities, and device implementations."
>
  <section class="card">
    <p class="muted">
      This section catalogs the actual <em>designs</em> (arrays, films, stents, noninvasive stacks, and packaging
      approaches) rather than company profiles.
    </p>
  </section>

  {posts.length ? (
    <section class="card">
      <h2>All designs</h2>
      <div class="list">
        {posts.map((p) => (
          <a class="item" href={`/designs/${p.slug}/`}>
            <h3>
              {stripPrefix(p.data.title)}
            </h3>
            <p class="desc">
              <span class="k">{p.data.modality}</span>
              {p.data.description ? ` — ${p.data.description}` : ""}
            </p>
          </a>
        ))}
      </div>
    </section>
  ) : (
    <section class="card">
      <h2>All designs</h2>
      <p class="muted">No design entries are published yet. Check back soon for canonical examples (Utah array, ECoG grid, Stentrode, and more).</p>
    </section>
  )}
</Layout>

<style>
  .card {
    margin-top: 14px;
    padding: 22px 22px;
    border-radius: 16px;
    border: 1px solid var(--border);
    background: var(--panel);
  }

  .muted {
    opacity: 0.72;
    margin: 0;
  }

  h2 {
    margin: 0 0 12px;
    font-size: 1.15em;
    font-weight: 700;
  }

  .list {
    display: grid;
    gap: 10px;
  }

  .item {
    display: block;
    padding: 14px 14px;
    border-radius: 14px;
    border: 1px solid var(--border);
    background: var(--panel);
    color: inherit;
    text-decoration: none;
  }

  .item:hover {
    border-color: var(--borderStrong);
    transform: translateY(-1px);
    background: var(--panelHover);
  }

  h3 {
    margin: 0;
    font-size: 1.05em;
    font-weight: 700;
  }

  .desc {
    margin: 8px 0 0;
    opacity: 0.78;
    line-height: 1.7;
  }

  .k {
    opacity: 0.9;
    font-weight: 700;
  }
</style>
